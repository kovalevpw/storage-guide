# storage-guide

### Все таблицы
должны содержать поля

1. Первичный ключ (BIGINT Signed)
2. Дата создания (TIMESTAMP)
3. Дата обновления (TIMESTAMP)

### Таблицы данных

1. Не должны ссылаться на другие таблицы (не содержат внешних ключей)

#### Пример таблицы пользователей

| user_id | email               | password_hash | last_name     | last_name | middle_name |          created_at |          updated_at |
|--------:|:--------------------|:--------------|:--------------|:----------|:------------|--------------------:|--------------------:|
|       1 | admin@example.com   | a1b3c4...     | Administrator | NULL      | NULL        | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|       2 | user@example.com    | b1b3c4...     | Иванов        | Иван      | Иванович    | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|       3 | support@example.com | c1b3c4...     | Петров        | Петр      | Петрович    | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |

#### Пример таблицы групп пользователей

| user_group_id | name     |          created_at |          updated_at |
|--------------:|:---------|--------------------:|--------------------:|
|             1 | admins   | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|             2 | users    | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|             3 | supports | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |

#### Пример таблицы флагов

| user_flag_id | name                   |          created_at |          updated_at |
|-------------:|:-----------------------|--------------------:|--------------------:|
|            1 | user.edit_all          | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            2 | user.edit_profile_self | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            3 | user.edit_profile_all  | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            4 | page.create            | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            5 | page.update_all        | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            6 | page.delete_all        | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            7 | page.update_self       | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|            8 | page.delete_self       | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |

#### Пример таблицы языков

| language_id | name    | slug | locale  |             created_at |            updated_at |
|------------:|:--------|:----:|:-------:|-----------------------:|----------------------:|
|           1 | English |  en  |  en-US  |    1970-01-01 00:00:00 |   1970-01-01 00:00:00 |
|           2 | Русский |  ru  |  ru-RU  |    1970-01-01 00:00:00 |   1970-01-01 00:00:00 |

### Таблицы связей

1. Не должны содержать никаких данных
2. Должны ссылаться на другие таблицы через внешний ключ
3. Должны иметь общий уникальный индекс для всех внешних ключей

#### Пример таблицы связей групп пользователей

|   id | user_group_id | user_flag_id |          created_at |          updated_at |
|-----:|--------------:|-------------:|--------------------:|--------------------:|
|    1 |             1 |            1 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    2 |             1 |            2 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    3 |             1 |            3 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    4 |             1 |            4 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    5 |             1 |            5 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    6 |             1 |            6 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    7 |             1 |            7 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    8 |             1 |            8 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|    9 |             2 |            2 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   10 |             2 |            3 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   11 |             2 |            4 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   12 |             2 |            5 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   13 |             2 |            6 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   14 |             2 |            7 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   15 |             2 |            8 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   16 |             3 |            2 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   17 |             3 |            4 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   18 |             3 |            7 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   19 |             3 |            8 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |

#### Пример таблицы связей пользователей

|  id | user_id | user_group_id |        language_id |          created_at |          updated_at |
|----:|--------:|--------------:|-------------------:|--------------------:|--------------------:|
|   1 |       1 |             1 |               NULL | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   2 |       1 |          NULL |                  1 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   3 |       2 |             2 |               NULL | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   4 |       2 |          NULL |                  2 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   5 |       3 |             3 |               NULL | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |
|   6 |       3 |          NULL |                  2 | 1970-01-01 00:00:00 | 1970-01-01 00:00:00 |

